name: Jekyll site CI

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4
    - name: Build the site in the jekyll/builder container
      run: |
        docker run \
        -v ${{ github.workspace }}:/srv/jekyll -v ${{ github.workspace }}/_site:/srv/jekyll/_site \
        jekyll/builder:latest /bin/bash -c "chmod -R 777 /srv/jekyll && jekyll build --future"
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯¼æ•°æ‰¾ä¸åŒ - åœ¨çº¿æ•°å­¦æ¸¸æˆ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d); color: white; min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .container { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius: 20px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); width: 90%; max-width: 900px; text-align: center; }
        h1 { margin-bottom: 10px; font-size: 2.8rem; background: linear-gradient(to right, #ff7e5f, #feb47b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .game-info { display: flex; justify-content: space-between; margin-bottom: 25px; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 12px; }
        .options { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .option { background: rgba(255,255,255,0.2); padding: 20px; border-radius: 12px; cursor: pointer; transition: all 0.3s ease; font-size: 1.3rem; }
        .option:hover { background: rgba(255,255,255,0.3); transform: translateY(-5px); }
        button { background: linear-gradient(to right, #ff7e5f, #feb47b); color: white; border: none; padding: 12px 25px; border-radius: 50px; font-size: 1.1rem; cursor: pointer; margin: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§® å¯¼æ•°æ‰¾ä¸åŒ</h1>
        <p>åœ¨çº¿æ•°å­¦æŒ‘æˆ˜ - æ‰¾å‡ºå¯¼æ•°ä¸åŒçš„å‡½æ•°</p>
        
        <div class="game-info">
            <div>å¾—åˆ†: <span id="score">0</span>/10</div>
            <div>éš¾åº¦: <span id="level">1</span></div>
            <div>ç”Ÿå‘½: <span id="lives">3</span></div>
        </div>
        
        <div class="game-area">
            <div class="question" id="question">ç‚¹å‡»é€‰é¡¹å¼€å§‹æ¸¸æˆ</div>
            <div class="options" id="options"></div>
            <div class="feedback" id="feedback"></div>
            <div class="game-over" id="game-over"></div>
            <button id="hint-btn">ğŸ’¡ æç¤º (3)</button>
            <button id="restart-btn" style="display:none;">ğŸ”„ é‡æ–°å¼€å§‹</button>
        </div>
    </div>

    <script>
        let score = 0, level = 1, lives = 3, hints = 3, gameActive = true;
        const functionGenerators = [
            () => { const a = Math.floor(Math.random()*5)+1, b = Math.floor(Math.random()*11)-5; return {func: `${a}x + ${b}`, derivative: `${a}`}; },
            () => { const a = Math.floor(Math.random()*3)+1, b = Math.floor(Math.random()*7)-3, c = Math.floor(Math.random()*11)-5; return {func: `${a}xÂ² + ${b}x + ${c}`, derivative: `${2*a}x + ${b}`}; },
            () => { const a = Math.floor(Math.random()*2)+1, b = Math.floor(Math.random()*5)-2, c = Math.floor(Math.random()*7)-3, d = Math.floor(Math.random()*11)-5; return {func: `${a}xÂ³ + ${b}xÂ² + ${c}x + ${d}`, derivative: `${3*a}xÂ² + ${2*b}x + ${c}`}; }
        ];
        
        function generateQuestion() {
            const optionCount = Math.min(4 + Math.floor(score/3), 6);
            const baseIndex = Math.floor(Math.random()*functionGenerators.length);
            const baseDerivative = functionGenerators[baseIndex]().derivative;
            const functions = [];
            const usedFuncs = new Set();
            
            for(let i=0; i<optionCount-1; i++) {
                let func; do { func = functionGenerators[baseIndex](); } while(usedFuncs.has(func.func));
                usedFuncs.add(func.func); functions.push({...func, isDifferent: false});
            }
            
            let diffFunc; do {
                const diffIndex = Math.floor(Math.random()*functionGenerators.length);
                diffFunc = functionGenerators[diffIndex]();
            } while(usedFuncs.has(diffFunc.func) || diffFunc.derivative === baseDerivative);
            
            functions.push({...diffFunc, isDifferent: true});
            functions.sort(() => Math.random()-0.5);
            return {functions, correctIndex: functions.findIndex(f=>f.isDifferent)};
        }
        
        function displayQuestion(question) {
            document.getElementById('question').innerHTML = "æ‰¾å‡º<span style='color:#ffeb3b'>å¯¼æ•°ä¸åŒ</span>çš„å‡½æ•°:";
            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';
            question.functions.forEach((func, index) => {
                const option = document.createElement('div');
                option.className = 'option';
                option.innerHTML = `f(x) = ${func.func}`;
                option.onclick = () => gameActive && checkAnswer(index, question.correctIndex);
                optionsContainer.appendChild(option);
            });
        }
        
        function checkAnswer(selected, correct) {
            const options = document.querySelectorAll('.option');
            if(selected === correct) {
                score++; document.getElementById('score').textContent = score;
                document.getElementById('feedback').textContent = "âœ… æ­£ç¡®ï¼";
                options[selected].style.background = "linear-gradient(to right, rgba(76,175,80,0.7), rgba(56,142,60,0.7))";
            } else {
                score = Math.max(0,score-1); lives--;
                document.getElementById('score').textContent = score;
                document.getElementById('lives').textContent = lives;
                document.getElementById('feedback').textContent = "âŒ é”™è¯¯ï¼";
                options[selected].style.background = "linear-gradient(to right, rgba(244,67,54,0.7), rgba(198,40,40,0.7))";
                options[correct].style.background = "linear-gradient(to right, rgba(76,175,80,0.7), rgba(56,142,60,0.7))";
            }
            
            document.getElementById('level').textContent = Math.floor(score/3)+1;
            options.forEach(opt => opt.style.pointerEvents = 'none');
            
            if(score>=10) endGame("ğŸ‰ æ­å–œï¼ä½ èµ¢äº†ï¼");
            else if(lives<=0) endGame("ğŸ’€ æ¸¸æˆç»“æŸï¼");
            else setTimeout(() => { if(gameActive) { displayQuestion(generateQuestion()); document.getElementById('feedback').textContent = ''; } }, 1500);
        }
        
        function endGame(msg) {
            gameActive = false;
            document.getElementById('game-over').textContent = msg;
            document.getElementById('restart-btn').style.display = 'inline-block';
        }
        
        document.getElementById('restart-btn').onclick = () => {
            score=0; level=1; lives=3; hints=3; gameActive=true;
            document.getElementById('score').textContent = score;
            document.getElementById('level').textContent = level;
            document.getElementById('lives').textContent = lives;
            document.getElementById('game-over').textContent = '';
            document.getElementById('feedback').textContent = '';
            document.getElementById('restart-btn').style.display = 'none';
            displayQuestion(generateQuestion());
        };
        
        document.getElementById('hint-btn').onclick = function() {
            if(hints<=0 || !gameActive || !currentQuestion) return;
            hints--; this.textContent = `ğŸ’¡ æç¤º (${hints})`;
            const options = document.querySelectorAll('.option');
            const wrongOptions = [...options].filter((_,i) => i !== currentQuestion.correctIndex);
            if(wrongOptions.length) {
                const randomWrong = wrongOptions[Math.floor(Math.random()*wrongOptions.length)];
                randomWrong.style.opacity = '0.4';
                randomWrong.style.pointerEvents = 'none';
            }
            if(hints<=0) { this.disabled=true; this.style.opacity='0.5'; }
        };
        
        let currentQuestion;
        function initGame() {
            currentQuestion = generateQuestion();
            displayQuestion(currentQuestion);
        }
        initGame();
    </script>
</body>
</html>
